(window.MIP=window.MIP||[]).push({name:"mip-showmore",func:function(){define("mip-showmore/mip-showmore",["require","customElement","util","viewport"],function(t){function i(t){var i,e=t.ele,o=t.type;if(o&&e){if(void 0===t.transitionTime||isNaN(t.transitionTime))i=.24;else i=Math.min(parseFloat(t.transitionTime),1);var s,h=void 0!==t.oriHeight?t.oriHeight:getComputedStyle(e).height,n=t.cbFun||function(){};if("unfold"===o){if(void 0!==t.tarHeight)s=t.tarHeight;else e.style.transition="height 0s",e.style.height="auto",s=getComputedStyle(e).height;setTimeout(function(){e.style.transition="height 0s",e.style.height="auto"},1e3*i)}else if("fold"===o)s=t.tarHeight||0;e.style.height=h,setTimeout(function(){e.style.transition="height "+i+"s",e.style.height=s},10),setTimeout(function(){n()},1e3*i)}}var e=t("customElement").create(),o=t("util"),s=t("viewport"),h=function(t){if(this.ele=t,this.clickBtn=t.querySelector("[showmorebtn]"),this.showBox=this.ele.querySelector("[showmorebox]"),this.animateTime=this.ele.getAttribute("animatetime")||0,!this.showBox)this.showBox=this.ele};return h.prototype.init=function(){if(!isNaN(this.animateTime)){if(this.maxHeight=this.ele.getAttribute("maxheight"),this.maxLen=this.ele.getAttribute("maxlen"),this.bottomShadow="1"===this.ele.getAttribute("bottomshadow"),this.bottomShadowClassName="linear-gradient",this.maxHeight&&isNaN(this.maxHeight)){var t,i,e=this.maxHeight.split(":");if(e.length>1)switch(t=e[0].trim(),i=e[1].trim(),t){case"screen":this.showType="HEIGHTSCREEN",this.maxHeight=s.getHeight()*i,this._initHeight();break;case"heightpx":this.showType="HEIGHT",this._initHeight()}}else if(this.maxHeight&&!isNaN(this.maxHeight))this.showType="HEIGHT",this._initHeight();else if(this.maxLen&&!isNaN(this.maxLen))this.showType="LENGTH",this._maxLenFn();else this.maxHeight=0,this._initHeight();this._bindClick(),o.css(this.ele,{visibility:"visible"})}},h.prototype._initHeight=function(){if(this.showBoxHei=o.rect.getElementOffset(this.showBox).height,this.showBoxHei>this.maxHeight){o.css(this.showBox,{height:this.maxHeight+"px",overflow:"hidden"});var t=this.ele.querySelector(".mip-showmore-btnshow");o.css(t,{display:"block"}),this.bottomShadow&&this.showBox.classList.add(this.bottomShadowClassName)}},h.prototype._maxLenFn=function(){if(this.originalHtml=this.showBox.innerHTML,this.cutOffText=this._cutHtmlStr(this.maxLen),this.originalHtml.length!==this.cutOffText.length){var t=this.ele.querySelector(".mip-showmore-btnshow");o.css(t,{display:"block"}),this.bottomShadow&&this.showBox.classList.add(this.bottomShadowClassName),this.cutOffText="<p class='mip-showmore-abstract'>"+this.cutOffText+"...</p>",this.showBox.innerHTML=this.cutOffText}},h.prototype._bindClick=function(){if(this.clickBtn){var t=this;this.clickBtn.addEventListener("click",function(i){t.toggle.apply(t)})}},h.prototype.toggle=function(t){var e=this.ele.classList,o=t?t.target:null,s={};if(s.aniTime=this.animateTime||.3,"LENGTH"===this.showType)if(s.oriHeight=getComputedStyle(this.showBox).height,e.contains("mip-showmore-boxshow"))this.showBox.innerHTML=this.cutOffText,s.tarHeight=getComputedStyle(this.showBox).height,this.showBox.innerHTML=this.originalHtml,s.type="fold",s.cbFun=function(t){t.showBox.innerHTML=t.cutOffText,t._toggleClickBtn(o,"showOpen"),e.remove("mip-showmore-boxshow")}.bind(void 0,this);else e.add("mip-showmore-boxshow"),this.showBox.innerHTML=this.originalHtml,s.type="unfold",s.cbFun=function(t){t._toggleClickBtn(o,"showClose")}.bind(void 0,this);else if("HEIGHT"===this.showType||"HEIGHTSCREEN"===this.showType)if(e.contains("mip-showmore-boxshow"))this.bottomShadow&&this.showBox.classList.add(this.bottomShadowClassName),e.remove("mip-showmore-boxshow"),s.type="fold",s.tarHeight=this.maxHeight+"px",s.cbFun=function(t,i){t._toggleClickBtn(i,"showOpen")}.bind(void 0,this,o);else this.bottomShadow&&this.showBox.classList.remove(this.bottomShadowClassName),e.add("mip-showmore-boxshow"),s.type="unfold",s.cbFun=function(t,i){t._toggleClickBtn(i,"showClose")}.bind(void 0,this,o);i({ele:this.showBox,type:s.type,transitionTime:s.aniTime,tarHeight:s.tarHeight,oriHeight:s.oriHeight,cbFun:s.cbFun})},h.prototype._toggleClickBtn=function(t,i){if(i)if("showOpen"===i){if(t)t.innerText=t.dataset.opentext;this._changeBtnText({display:"block"},{display:"none"})}else{if(t){var e=t.innerText;t.innerText=t.dataset.closetext||"收起",t.dataset.opentext=e}this._changeBtnText({display:"none"},{display:"block"})}},h.prototype._cutHtmlStr=function(t){for(var i=this.showBox.childNodes,e="",o=0,s=[],h=0;h<i.length;h++){var n=i[h].textContent.replace(/(^\s*)|(\s*$)/g,"");if(e.length+n.length<=t)e+=n,o=e.length,s.push(i[h]);else{var r=t-o>0?t-o:o-t,a=n?n.slice(0,r):"";i[h].textContent=a,s.push(i[h]);break}}for(var l="",m=0;m<s.length;m++){var c=s[m].nodeType;if(1===c)l+=s[m].outerHTML;else if(3===c)l+=s[m].textContent}return l},h.prototype._changeBtnText=function(t,i){var e=this.ele.querySelector(".mip-showmore-btnshow"),o=this.ele.querySelector(".mip-showmore-btnhide");this._changeBtnShow(e,t),this._changeBtnShow(o,i)},h.prototype._changeBtnShow=function(t,i){o.css(t,i)},e.prototype.build=function(){var t=this.element,i=new h(t);i.init(),this.addEventAction("toggle",function(t){i.toggle(t)})},e}),define("mip-showmore",["mip-showmore/mip-showmore"],function(t){return t}),function(){function t(t,i){t.registerMipElement("mip-showmore",i,'mip-showmore{visibility:hidden;overflow:hidden;transform:translateZ(0)}mip-showmore .mip-showmore-originalhtml,mip-showmore .mip-showmore-btnhide,mip-showmore .mip-showmore-btnshow{display:none}mip-showmore.linear-gradient:after{content:"";position:absolute;bottom:0;display:block;width:100%;height:90px;background:-moz-linear-gradient(to bottom, rgba(255,255,255,0), #fff);background:-webkit-linear-gradient(to bottom, rgba(255,255,255,0), #fff);background:linear-gradient(to bottom, rgba(255,255,255,0), #fff)}mip-showmore [showmorebox]{overflow:hidden}.mip-showmore-btn{border:1px solid #ddd;background:#fafafa;display:inline-block;padding:15px}.mip-showmore-btn:hover,.mip-showmore-btn:active{background:#f0f0f0}')}if(window.MIP)require(["mip-showmore"],function(i){t(window.MIP,i)});else require(["mip","mip-showmore"],t)}()}});